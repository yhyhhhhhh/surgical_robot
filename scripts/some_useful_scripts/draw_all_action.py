import torch
import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# 粘贴你的 tensor 数据（假设变量名为 `traj_tensor`）
traj_tensor = torch.tensor([[ 9.5191e-01, -4.1262e-01, -6.0990e-01],
        [ 5.6351e-01,  1.6703e-01, -2.4324e-01],
        [ 3.3703e-01,  3.9065e-01, -1.1458e-01],
        [ 5.2797e-01,  9.3936e-02, -2.4312e-01],
        [ 9.0221e-01, -3.4168e-01, -5.7436e-01],
        [-8.3029e-02,  3.8525e-01, -2.0190e-02],
        [ 8.8590e-01, -1.6142e-01, -4.9620e-01],
        [ 7.6194e-01, -3.4372e-01, -5.1677e-01],
        [ 5.3727e-01,  9.8033e-02, -2.8179e-01],
        [ 6.5645e-01, -9.0932e-03, -3.7406e-01],
        [ 7.7155e-01, -2.4037e-01, -5.1607e-01],
        [ 8.6794e-01, -2.4485e-01, -4.9034e-01],
        [ 2.6311e-01,  2.3216e-01, -1.9021e-01],
        [ 6.4145e-01, -2.0107e-01, -4.8967e-01],
        [ 4.7676e-01, -6.6041e-02, -3.4494e-01],
        [ 5.3434e-01, -1.4983e-02, -3.4585e-01],
        [ 2.2709e-01,  4.0320e-01, -6.5234e-02],
        [ 5.8607e-01,  6.8643e-02, -2.5958e-01],
        [ 4.3758e-01,  1.9878e-01, -2.1858e-01],
        [ 4.7048e-01,  8.1551e-02, -3.0766e-01],
        [ 3.5152e-01,  3.3855e-01, -1.2199e-01],
        [ 6.9137e-01, -6.5554e-02, -3.9913e-01],
        [ 8.9117e-01, -4.3045e-01, -5.9745e-01],
        [ 1.0448e-01,  1.8221e-01, -1.9557e-01],
        [ 4.8271e-01, -1.4077e-01, -4.0018e-01],
        [ 1.6482e-01,  4.0951e-01, -5.0786e-02],
        [ 4.4784e-01, -9.7903e-02, -3.8875e-01],
        [ 3.1494e-01,  1.3624e-01, -2.2686e-01],
        [ 8.5052e-01, -2.8165e-01, -5.3995e-01],
        [ 7.5129e-01, -2.1881e-01, -5.0004e-01],
        [ 3.3069e-01,  1.4465e-01, -2.2096e-01],
        [ 3.2103e-01,  1.5510e-01, -2.3045e-01],
        [ 2.5907e-01,  3.9317e-01, -1.1555e-01],
        [ 4.4941e-01, -1.5185e-01, -4.2254e-01],
        [ 6.5571e-01, -3.7522e-01, -5.4660e-01],
        [ 5.4530e-01,  1.2788e-02, -3.3948e-01],
        [ 5.0633e-01,  1.8396e-01, -2.5124e-01],
        [ 1.8838e-01,  1.8983e-01, -1.7748e-01],
        [ 2.2808e-01,  5.5651e-02, -2.6740e-01],
        [ 8.2863e-01, -3.1496e-01, -5.5090e-01],
        [ 6.9292e-01, -1.1615e-01, -4.1754e-01],
        [ 4.1220e-01,  1.4051e-01, -2.4505e-01],
        [ 5.9710e-01, -3.8065e-01, -5.1547e-01],
        [ 4.4041e-01,  8.1396e-02, -3.1570e-01],
        [ 7.5135e-01, -2.6805e-01, -4.9621e-01],
        [ 5.3635e-01, -1.7280e-01, -4.7202e-01],
        [ 8.4764e-01, -3.3044e-01, -5.6518e-01],
        [ 6.2048e-01, -4.3678e-01, -5.4169e-01],
        [ 7.1382e-01, -2.5749e-01, -4.6948e-01],
        [ 8.2898e-01, -3.4141e-01, -5.4353e-01],
        [ 4.0664e-01,  2.9139e-01, -1.8970e-01],
        [ 6.7698e-01, -1.1851e-01, -4.0918e-01],
        [ 8.5546e-01, -3.7915e-01, -5.6605e-01],
        [ 7.2125e-02,  3.9438e-01,  2.6692e-02],
        [ 6.9854e-01, -2.4864e-01, -4.7268e-01],
        [ 4.8890e-01, -2.2635e-01, -4.3409e-01],
        [ 9.1118e-01, -4.2772e-01, -5.7086e-01],
        [ 4.0065e-01,  1.2880e-02, -3.2842e-01],
        [ 8.0584e-01, -4.0691e-01, -5.6672e-01],
        [ 8.6904e-01, -4.3661e-01, -6.1108e-01],
        [ 4.3266e-01,  1.2407e-01, -2.6801e-01],
        [ 9.2152e-02,  1.4299e-02, -2.5582e-01],
        [ 1.6328e-01,  1.6423e-01, -1.4146e-01],
        [ 5.9201e-01, -3.5813e-01, -5.3015e-01],
        [ 4.5408e-01,  1.0925e-01, -2.4994e-01],
        [ 3.9679e-01,  2.2357e-02, -3.0522e-01],
        [ 2.9950e-01, -8.2553e-03, -3.0143e-01],
        [ 5.1075e-01, -3.2664e-01, -4.8387e-01],
        [ 3.2174e-01,  1.9176e-01, -1.8256e-01],
        [ 6.8215e-01, -4.1540e-01, -5.3441e-01],
        [ 4.5139e-01,  1.8906e-01, -2.3544e-01],
        [ 6.8791e-01, -2.5973e-01, -4.7967e-01],
        [ 7.8748e-01, -3.2539e-01, -5.6874e-01],
        [ 8.5258e-01, -4.4656e-01, -5.9328e-01],
        [ 8.2604e-01, -3.8209e-01, -5.6460e-01],
        [ 5.5642e-01, -2.2527e-01, -4.7140e-01],
        [ 3.3925e-01,  1.5958e-01, -2.2787e-01],
        [ 3.9182e-01,  1.1371e-01, -2.6255e-01],
        [ 7.7706e-01, -4.7191e-01, -6.0744e-01],
        [ 3.6018e-01,  5.9532e-02, -2.8664e-01],
        [ 7.5825e-01, -2.2514e-01, -4.7828e-01],
        [ 7.9283e-01, -3.6727e-01, -5.4662e-01],
        [ 7.9247e-01, -3.9084e-01, -5.7092e-01],
        [ 3.6988e-01, -1.7287e-01, -4.2405e-01],
        [ 7.9087e-01, -2.8356e-01, -5.0448e-01],
        [ 5.6969e-01, -1.1391e-01, -4.1675e-01],
        [ 8.1262e-01, -3.3549e-01, -5.6326e-01],
        [ 7.0873e-01, -2.3284e-01, -5.1258e-01],
        [ 5.9481e-01, -2.5170e-01, -4.7240e-01],
        [ 8.0477e-01, -3.9047e-01, -5.7552e-01],
        [ 7.4435e-01, -3.0302e-01, -5.0615e-01],
        [ 8.6988e-01, -4.0332e-01, -5.8762e-01],
        [ 7.9696e-01, -3.1584e-01, -5.4219e-01],
        [ 8.0795e-01, -3.2747e-01, -5.3510e-01],
        [ 8.0289e-01, -3.6886e-01, -5.7272e-01],
        [ 8.7360e-01, -3.5310e-01, -5.8783e-01],
        [ 7.9071e-01, -3.2014e-01, -5.5117e-01],
        [ 7.3013e-01, -3.3079e-01, -5.1849e-01],
        [ 8.0135e-01, -3.3270e-01, -5.4160e-01],
        [ 8.1976e-01, -3.8128e-01, -5.5594e-01],
        [ 8.1741e-01, -3.9154e-01, -5.6748e-01],
        [ 7.1093e-01, -2.6652e-01, -4.9670e-01],
        [ 8.5563e-01, -4.0404e-01, -5.7595e-01],
        [ 7.2940e-01, -3.2541e-01, -5.0622e-01],
        [ 8.5057e-01, -3.7483e-01, -5.7492e-01],
        [ 7.7405e-01, -3.1955e-01, -5.3280e-01],
        [ 7.9554e-01, -3.0102e-01, -5.3609e-01],
        [ 8.2022e-01, -3.3556e-01, -5.3140e-01],
        [ 8.5166e-01, -3.6023e-01, -5.6296e-01],
        [ 7.5619e-01, -2.8950e-01, -5.2594e-01],
        [ 8.1719e-01, -3.6543e-01, -5.3822e-01],
        [ 7.9325e-01, -3.4996e-01, -5.3377e-01],
        [ 7.8492e-01, -3.3701e-01, -5.2949e-01],
        [ 7.6508e-01, -3.2907e-01, -5.2576e-01],
        [ 7.7031e-01, -2.4633e-01, -5.0966e-01],
        [ 7.1152e-01, -2.6946e-01, -4.8395e-01],
        [ 7.5473e-01, -2.9651e-01, -5.4392e-01],
        [ 7.6991e-01, -2.8409e-01, -5.0627e-01],
        [ 7.5707e-01, -2.6947e-01, -5.0691e-01],
        [ 8.2755e-01, -3.6824e-01, -5.4887e-01],
        [ 7.2307e-01, -2.0929e-01, -4.5744e-01],
        [ 8.1597e-01, -3.3464e-01, -5.5241e-01],
        [ 7.4553e-01, -2.1999e-01, -4.6830e-01],
        [ 7.6278e-01, -2.9733e-01, -5.2660e-01],
        [ 6.7018e-01, -2.0745e-01, -4.7106e-01],
        [ 8.0625e-01, -3.2704e-01, -5.2517e-01],
        [ 7.1415e-01, -2.5365e-01, -5.0335e-01],
        [ 7.2057e-01, -2.6414e-01, -4.9423e-01],
        [ 8.0178e-01, -1.9820e-01, -4.9438e-01],
        [ 8.0738e-01, -2.6018e-01, -5.0743e-01],
        [ 7.4279e-01, -1.5857e-01, -4.6795e-01],
        [ 7.6688e-01, -2.0750e-01, -4.7623e-01],
        [ 7.2496e-01, -2.0953e-01, -4.8169e-01],
        [ 6.6896e-01, -1.6185e-01, -4.2480e-01],
        [ 6.3251e-01, -1.4042e-01, -4.3837e-01],
        [ 6.5395e-01, -1.9242e-01, -4.5174e-01],
        [ 6.2097e-01, -1.1853e-01, -4.2898e-01],
        [ 6.5004e-01, -1.5507e-01, -4.3763e-01],
        [ 6.7614e-01, -1.3039e-01, -4.2028e-01],
        [ 6.1673e-01, -1.5902e-01, -4.3470e-01],
        [ 6.6750e-01, -1.7519e-01, -4.5012e-01],
        [ 6.9677e-01, -2.1409e-01, -4.6078e-01],
        [ 5.8983e-01, -1.5928e-01, -4.2572e-01],
        [ 5.9952e-01, -1.4583e-01, -4.4221e-01],
        [ 5.6144e-01, -5.2919e-02, -4.2169e-01],
        [ 5.8283e-01, -1.2582e-01, -4.2381e-01],
        [ 4.5073e-01, -1.3877e-01, -3.7779e-01],
        [ 5.7154e-01, -5.4458e-02, -3.7963e-01],
        [ 7.3286e-01, -7.1015e-02, -4.1154e-01],
        [ 1.2263e+00, -3.4468e-01, -5.0483e-01],
        [ 9.8842e-01, -6.9882e-02, -3.6925e-01],
        [ 4.5272e-01, -6.4049e-02, -3.5267e-01],
        [ 3.7823e-01, -4.1660e-02, -2.9136e-01],
        [ 5.1460e-01, -1.6057e-01, -3.8136e-01],
        [ 4.0067e-01, -6.2168e-02, -3.1603e-01],
        [ 5.0459e-01, -1.2238e-02, -2.9458e-01],
        [ 1.1110e+00, -2.2676e-01, -4.2420e-01],
        [ 1.0258e+00, -1.2587e-01, -3.4654e-01],
        [ 4.1570e-01,  9.2755e-02, -2.3772e-01],
        [ 9.4448e-01, -4.6243e-02, -2.9804e-01],
        [ 3.1749e-01,  4.6543e-02, -2.4897e-01],
        [ 9.8344e-01,  5.9136e-03, -3.0412e-01],
        [ 9.6261e-01, -1.5377e-01, -3.2741e-01],
        [ 6.9599e-01,  8.4078e-02, -2.0186e-01],
        [ 4.7467e-01,  5.5338e-02, -2.2273e-01],
        [ 7.2261e-01,  8.1066e-02, -1.8456e-01],
        [ 2.0136e-01,  1.7859e-01, -1.2230e-01],
        [ 7.4406e-01,  2.0196e-01, -1.0439e-01],
        [ 5.8152e-02,  2.6064e-01, -1.0792e-02],
        [ 8.6645e-02,  2.6269e-01, -2.6191e-02],
        [-4.3867e-02,  2.4409e-01,  1.3587e-02],
        [ 6.4211e-01,  2.0461e-01, -8.1410e-02],
        [ 5.8443e-01,  2.7501e-01, -4.8538e-02],
        [ 7.9346e-01,  7.6532e-02, -1.9350e-01],
        [ 5.3680e-01,  2.1389e-01, -6.0369e-02],
        [ 8.0478e-01,  1.0534e-01, -1.5749e-01],
        [ 5.0945e-01,  3.7417e-01, -5.1165e-04],
        [ 5.8807e-01,  2.4523e-01, -3.9183e-02],
        [ 4.7286e-01,  3.2892e-01,  2.8337e-02],
        [-1.9081e-02,  4.5223e-01,  1.7134e-01],
        [ 5.2976e-01,  2.7732e-01, -2.6845e-02],
        [ 4.1350e-01,  3.9208e-01,  5.2424e-02],
        [ 5.5259e-01,  2.7150e-01, -3.4927e-02],
        [ 5.3686e-01,  3.3142e-01, -2.8047e-02],
        [ 4.2050e-01,  3.8744e-01,  6.2781e-02],
        [-1.2851e-01,  4.8621e-01,  2.4039e-01],
        [ 2.3103e-01,  4.4197e-01,  1.4584e-01],
        [ 2.0887e-02,  5.1498e-01,  2.3171e-01],
        [ 1.9294e-01,  4.8112e-01,  1.6584e-01],
        [ 1.8329e-01,  4.7474e-01,  1.7113e-01],
        [ 1.8050e-01,  4.2916e-01,  1.7877e-01],
        [ 1.2670e-01,  4.9032e-01,  1.9868e-01],
        [ 9.3909e-02,  4.9274e-01,  2.2256e-01],
        [ 7.5207e-02,  5.1703e-01,  2.1832e-01],
        [ 2.2129e-01,  4.2123e-01,  1.3144e-01],
        [ 1.2012e-01,  5.2992e-01,  1.8757e-01],
        [ 7.1222e-02,  5.5663e-01,  2.0169e-01],
        [ 6.9813e-02,  5.5055e-01,  2.2078e-01],
        [-2.7759e-01,  5.2970e-01,  2.9657e-01],
        [ 1.1665e-01,  5.2285e-01,  1.9961e-01]], device='cuda:0')
# 转为 CPU 和 numpy 格式
positions = traj_tensor.cpu().numpy()

# 提取 X, Y, Z 分量
x, y, z = positions[:, 0], positions[:, 1], positions[:, 2]

# 创建 3D 图
fig = plt.figure(figsize=(10, 6))
ax = fig.add_subplot(111, projection='3d')

# 绘制轨迹线
ax.plot(x, y, z, label='Trajectory', color='blue')

# 标记起点与终点
ax.scatter(x[0], y[0], z[0], c='green', label='Start')
ax.scatter(x[-1], y[-1], z[-1], c='red', label='End')

# 设置标签
ax.set_xlabel('X')
ax.set_ylabel('Y')
ax.set_zlabel('Z')
ax.set_title('3D Trajectory Plot')
ax.legend()
ax.grid(True)

plt.tight_layout()
plt.show()
